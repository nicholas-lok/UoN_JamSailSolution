\doxysection{abacus\+\_\+fpga.\+h}
\hypertarget{abacus__fpga_8h_source}{}\label{abacus__fpga_8h_source}\index{E:/OneDrive -\/ The University of Nottingham/Year 5 Shared/FYP/Code/UoNCubeSat/lib/obc/abacus\_lib/FPGA/abacus\_fpga.h@{E:/OneDrive -\/ The University of Nottingham/Year 5 Shared/FYP/Code/UoNCubeSat/lib/obc/abacus\_lib/FPGA/abacus\_fpga.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ *\ The\ FPGA\ and\ the\ MSP430\ in\ ABACUS\ is\ connected\ with\ 3\ ports.\ You\ can}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ *\ use\ them\ as\ you\ want\ depending\ on\ your\ needs.\ However\ in\ this\ library}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ *\ we\ are\ using\ the\ interface\ as\ follows:}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ *\ \ -\/\ P1\ port\ is\ used\ as\ as\ control\ pins\ between\ FPGA\ and\ MSP}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ *\ \ \ \ \ \ *\ P1.0\ is\ reserve\ data\ bus\ (MSP\ Output)}}
\DoxyCodeLine{00007\ \textcolor{comment}{\ *\ \ \ \ \ \ *\ P1.1\ is\ FPGA\ Data\ Ready\ (MSP\ Input)}}
\DoxyCodeLine{00008\ \textcolor{comment}{\ *\ \ \ \ \ \ *\ P1.2\ is\ ClockSync\ to\ FPGA\ (MSP\ Output)}}
\DoxyCodeLine{00009\ \textcolor{comment}{\ *\ \ \ \ \ \ *\ P1.3\ is\ I2C\ reserve\ bus\ (MSP\ Output)}}
\DoxyCodeLine{00010\ \textcolor{comment}{\ *\ \ \ \ \ \ *\ P1.4\ is\ I2C\ busy\ bus\ (MSP\ Input)}}
\DoxyCodeLine{00011\ \textcolor{comment}{\ *\ \ \ \ \ \ *\ P1.5\ is\ for\ reseting\ the\ state\ machine}}
\DoxyCodeLine{00012\ \textcolor{comment}{\ *\ \ \ \ \ \ *\ P1.6\ is\ for\ generating\ interrupts\ from\ FPGA\ to\ MSP}}
\DoxyCodeLine{00013\ \textcolor{comment}{\ *\ \ \ \ \ \ *\ P1.7\ is\ unused}}
\DoxyCodeLine{00014\ \textcolor{comment}{\ *\ \ -\/\ P8\ as\ 8bit\ parallel\ port\ bidirectional}}
\DoxyCodeLine{00015\ \textcolor{comment}{\ *\ \ -\/\ P4\ as\ 8bit\ parallel\ port\ bidirectional}}
\DoxyCodeLine{00016\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00017\ \textcolor{comment}{\ *\ \ FPGA\ Control\ pins:}}
\DoxyCodeLine{00018\ \textcolor{comment}{\ *\ \ -\/\ P2.5\ as\ power\ enable\ to\ switch\ on/off\ the\ FPGA}}
\DoxyCodeLine{00019\ \textcolor{comment}{\ *\ \ -\/\ P10.3\ as\ ProgB\ pin}}
\DoxyCodeLine{00020\ \textcolor{comment}{\ *\ \ -\/\ P7.7\ as\ analog\ input\ to\ read\ the\ status\ of\ the\ FPGA\ "{}Done"{}\ output}}
\DoxyCodeLine{00021\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00022\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#ifndef\ ABACUS\_FPGA\_H\_}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#define\ ABACUS\_FPGA\_H\_}}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{abacus_8h}{../abacus.h}}"{}}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#include\ "{}stdint.h"{}}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \textcolor{comment}{//\ P1.0\ pin\ output\ Reserve\ data\ bus\ putting\ it\ low}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#define\ FPGA\_Reserve\_DataBus\ (P1OUT\ |=\ BIT0)\ }\textcolor{comment}{//\ Set\ P1.0=1}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#define\ FPGA\_Release\_DataBus\ (P1OUT\ \&=\ \string~BIT0)\ }\textcolor{comment}{//\ Set\ P1.0=0}}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \textcolor{comment}{//\ P1.1\ pin\ input\ to\ check\ if\ FPGA\ is\ using\ Data\ Bus}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#define\ FPGA\_Data\_Ready\ (P1IN\ \&\ BIT1)}}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \textcolor{comment}{//\ P1.2\ pin\ output\ for\ clock\ sync}}
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#define\ FPGA\_CkSyncToFPGA\_High\ (P1OUT\ |=\ BIT2)\ }\textcolor{comment}{//\ Set\ P1.2=1}}
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#define\ FPGA\_CkSyncToFPGA\_Low\ (P1OUT\ \&=\ \string~BIT2)\ }\textcolor{comment}{//\ Set\ P1.2=0}}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \textcolor{comment}{//\ P1.3\ pin\ output\ reserve\ I2C\ bus}}
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\#define\ FPGA\_Reserve\_I2CBus\ (P1OUT\ |=\ BIT3)\ }\textcolor{comment}{//\ Set\ P1.3=1}}
\DoxyCodeLine{00043\ \textcolor{preprocessor}{\#define\ FPGA\_Release\_I2CBus\ (P1OUT\ \&=\ \string~BIT3)\ }\textcolor{comment}{//\ Set\ P1.3=0}}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \textcolor{comment}{//\ P1.4\ pin\ input\ for\ checking\ if\ FPGA\ is\ using\ I2C}}
\DoxyCodeLine{00046\ \textcolor{preprocessor}{\#define\ FPGA\_I2CBus\_Busy\ (P1IN\ \&\ BIT4)}}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \textcolor{comment}{//\ P1.5\ pin\ output\ for\ reseting\ the\ fst\ of\ FPGA}}
\DoxyCodeLine{00049\ \textcolor{preprocessor}{\#define\ FPGA\_ResetFst\_Hi\ \ \ \ (P1OUT\ |=\ BIT5)}}
\DoxyCodeLine{00050\ \textcolor{preprocessor}{\#define\ FPGA\_ResetFst\_Low\ \ \ (P1OUT\ \&=\ \string~BIT5)}}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \textcolor{comment}{//\ P1.6\ input\ pin\ for\ interrupt\ from\ FPGA}}
\DoxyCodeLine{00053\ \textcolor{comment}{//\ P1.7\ Not\ used\ yet\ but\ available\ on\ hardware}}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \textcolor{comment}{//Pins\ for\ switching\ on\ or\ off}}
\DoxyCodeLine{00056\ \textcolor{preprocessor}{\#define\ FPGA\_ON\ (P2OUT\ \&=\ \string~BIT5)}}
\DoxyCodeLine{00057\ \textcolor{preprocessor}{\#define\ FPGA\_OFF\ (P2OUT\ |=\ BIT5)}}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \textcolor{comment}{//\ Set\ the\ low\ and\ high\ bytes\ of\ databus\ to\ input\ or\ output}}
\DoxyCodeLine{00060\ \textcolor{preprocessor}{\#define\ FPGA\_LOWBYTE\_asInput\ \ \ \ (P8DIR\ =\ 0x00)}}
\DoxyCodeLine{00061\ \textcolor{preprocessor}{\#define\ FPGA\_LOWBYTE\_asOutput\ \ \ (P8DIR\ =\ 0xFF)}}
\DoxyCodeLine{00062\ \textcolor{preprocessor}{\#define\ FPGA\_HIGHBYTE\_asInput\ \ \ (P4DIR\ =\ 0x00)}}
\DoxyCodeLine{00063\ \textcolor{preprocessor}{\#define\ FPGA\_HIGHBYTE\_asOutput\ \ (P4DIR\ =\ 0xFF)}}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \textcolor{comment}{//\ Easy\ access\ to\ low\ or\ high\ bytes\ (input\ or\ output)}}
\DoxyCodeLine{00066\ \textcolor{preprocessor}{\#define\ FPGA\_LOWBYTE\_OUT\ \ \ \ (P8OUT)}}
\DoxyCodeLine{00067\ \textcolor{preprocessor}{\#define\ FPGA\_LOWBYTE\_IN\ \ \ \ \ (P8IN)}}
\DoxyCodeLine{00068\ \textcolor{preprocessor}{\#define\ FPGA\_HIGHBYTE\_OUT\ \ \ (P4OUT)}}
\DoxyCodeLine{00069\ \textcolor{preprocessor}{\#define\ FPGA\_HIGHBYTE\_IN\ \ \ \ (P4IN)}}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \textcolor{keyword}{extern}\ void\ (*triggerFPGAFunction)(\textcolor{keywordtype}{int}*);}
\DoxyCodeLine{00072\ \textcolor{keyword}{extern}\ int8\_t\ fpgaInterruptEnabled;}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \textcolor{keywordtype}{void}\ abacus\_fpga\_init();}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ int8\_t\ abacus\_fpga\_isOn();}
\DoxyCodeLine{00077\ int8\_t\ abacus\_fpga\_isProgrammed();}
\DoxyCodeLine{00078\ int8\_t\ abacus\_fpga\_switchOn();}
\DoxyCodeLine{00079\ int8\_t\ abacus\_fpga\_switchOff();}
\DoxyCodeLine{00080\ int8\_t\ abacus\_fpga\_FSM\_reset();}
\DoxyCodeLine{00081\ int8\_t\ abacus\_fpga\_cold\_reset();}
\DoxyCodeLine{00082\ int8\_t\ abacus\_fpga\_resetProgram();}
\DoxyCodeLine{00083\ int8\_t\ abacus\_fpga\_prgB\_holdDown();}
\DoxyCodeLine{00084\ int8\_t\ abacus\_fpga\_prgB\_holdUp();}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ int8\_t\ abacus\_fpga\_i2cGetStatus();}
\DoxyCodeLine{00087\ int8\_t\ abacus\_fpga\_i2cReserve();}
\DoxyCodeLine{00088\ int8\_t\ abacus\_fpga\_i2cRelease();}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ int8\_t\ abacus\_fpga\_interruptisOn();}
\DoxyCodeLine{00091\ int8\_t\ abacus\_fpga\_interruptEnable(\textcolor{keywordtype}{void}\ (*interruptFunction)(\textcolor{keywordtype}{int}*));}
\DoxyCodeLine{00092\ int8\_t\ abacus\_fpga\_interruptDisable();}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ int8\_t\ abacus\_fpga\_dataBusReserve();}
\DoxyCodeLine{00096\ int8\_t\ abacus\_fpga\_dataBusRelease();}
\DoxyCodeLine{00097\ int8\_t\ abacus\_fpga\_dataBusSetHighZ();}
\DoxyCodeLine{00098\ int8\_t\ abacus\_fpga\_dataBusSetLowZ();}
\DoxyCodeLine{00099\ int8\_t\ abacus\_fpga\_dataBusSendData(uint16\_t\ data);}
\DoxyCodeLine{00100\ int8\_t\ abacus\_fpga\_dataBusSendArray(uint16\_t\ *buffer,\ uint16\_t\ lenght);}
\DoxyCodeLine{00101\ int8\_t\ abacus\_fpga\_dataBusSendArray\_8bit(uint8\_t\ *buffer,\ uint16\_t\ lenght);}
\DoxyCodeLine{00102\ int8\_t\ abacus\_fpga\_dataBusGetData(uint16\_t\ *buffer);}
\DoxyCodeLine{00103\ int8\_t\ abacus\_fpga\_dataBusGetArray(uint16\_t\ *buffer,\ uint16\_t\ lenght);}
\DoxyCodeLine{00104\ int8\_t\ abacus\_fpga\_dataBusGetArray\_8bit(uint8\_t\ *buffer,\ uint16\_t\ lenght);}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*\ ABACUS\_FPGA\_H\_\ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
