\chapter{inih (INI Not Invented Here)}
\hypertarget{md_lib_2utils_2win_2inih_2_r_e_a_d_m_e}{}\label{md_lib_2utils_2win_2inih_2_r_e_a_d_m_e}\index{inih (INI Not Invented Here)@{inih (INI Not Invented Here)}}
\label{md_lib_2utils_2win_2inih_2_r_e_a_d_m_e_autotoc_md0}%
\Hypertarget{md_lib_2utils_2win_2inih_2_r_e_a_d_m_e_autotoc_md0}%
 \href{https://github.com/benhoyt/inih/actions/workflows/tests.yml}{\texttt{ }}

{\bfseries{inih (INI Not Invented Here)}} is a simple \href{http://en.wikipedia.org/wiki/INI_file}{\texttt{ .INI file}} parser written in C. It\textquotesingle{}s only a couple of pages of code, and it was designed to be {\itshape small and simple}, so it\textquotesingle{}s good for embedded systems. It\textquotesingle{}s also more or less compatible with Python\textquotesingle{}s \href{http://docs.python.org/library/configparser.html}{\texttt{ Config\+Parser}} style of .INI files, including RFC 822-\/style multi-\/line syntax and {\ttfamily name\+: value} entries.

To use it, just give {\ttfamily ini\+\_\+parse()} an INI file, and it will call a callback for every {\ttfamily name=value} pair parsed, giving you strings for the section, name, and value. It\textquotesingle{}s done this way ("{}\+SAX style"{}) because it works well on low-\/memory embedded systems, but also because it makes for a KISS implementation.

You can also call {\ttfamily ini\+\_\+parse\+\_\+file()} to parse directly from a {\ttfamily FILE\texorpdfstring{$\ast$}{*}} object, {\ttfamily ini\+\_\+parse\+\_\+string()} to parse data from a string, or {\ttfamily ini\+\_\+parse\+\_\+stream()} to parse using a custom fgets-\/style reader function for custom I/O.

Download a release, browse the source, or read about \href{http://blog.brush.co.nz/2009/08/xmacros/}{\texttt{ how to use inih in a DRY style}} with X-\/\+Macros.\hypertarget{md_lib_2utils_2win_2inih_2_r_e_a_d_m_e_autotoc_md1}{}\doxysection{\texorpdfstring{Compile-\/time options}{Compile-\/time options}}\label{md_lib_2utils_2win_2inih_2_r_e_a_d_m_e_autotoc_md1}
You can control various aspects of inih using preprocessor defines\+:\hypertarget{md_lib_2utils_2win_2inih_2_r_e_a_d_m_e_autotoc_md2}{}\doxysubsection{\texorpdfstring{Syntax options}{Syntax options}}\label{md_lib_2utils_2win_2inih_2_r_e_a_d_m_e_autotoc_md2}

\begin{DoxyItemize}
\item {\bfseries{Multi-\/line entries\+:}} By default, inih supports multi-\/line entries in the style of Python\textquotesingle{}s Config\+Parser. To disable, add {\ttfamily -\/DINI\+\_\+\+ALLOW\+\_\+\+MULTILINE=0}.
\item {\bfseries{UTF-\/8 BOM\+:}} By default, inih allows a UTF-\/8 BOM sequence (0x\+EF 0x\+BB 0x\+BF) at the start of INI files. To disable, add {\ttfamily -\/DINI\+\_\+\+ALLOW\+\_\+\+BOM=0}.
\item {\bfseries{Inline comments\+:}} By default, inih allows inline comments with the {\ttfamily ;} character. To disable, add {\ttfamily -\/DINI\+\_\+\+ALLOW\+\_\+\+INLINE\+\_\+\+COMMENTS=0}. You can also specify which character(s) start an inline comment using {\ttfamily INI\+\_\+\+INLINE\+\_\+\+COMMENT\+\_\+\+PREFIXES}.
\item {\bfseries{Start-\/of-\/line comments\+:}} By default, inih allows both {\ttfamily ;} and {\ttfamily \#} to start a comment at the beginning of a line. You can override this by changing {\ttfamily INI\+\_\+\+START\+\_\+\+COMMENT\+\_\+\+PREFIXES}.
\item {\bfseries{Allow no value\+:}} By default, inih treats a name with no value (no {\ttfamily =} or {\ttfamily \+:} on the line) as an error. To allow names with no values, add {\ttfamily -\/DINI\+\_\+\+ALLOW\+\_\+\+NO\+\_\+\+VALUE=1}, and inih will call your handler function with value set to NULL.
\end{DoxyItemize}\hypertarget{md_lib_2utils_2win_2inih_2_r_e_a_d_m_e_autotoc_md3}{}\doxysubsection{\texorpdfstring{Parsing options}{Parsing options}}\label{md_lib_2utils_2win_2inih_2_r_e_a_d_m_e_autotoc_md3}

\begin{DoxyItemize}
\item {\bfseries{Stop on first error\+:}} By default, inih keeps parsing the rest of the file after an error. To stop parsing on the first error, add {\ttfamily -\/DINI\+\_\+\+STOP\+\_\+\+ON\+\_\+\+FIRST\+\_\+\+ERROR=1}.
\item {\bfseries{Report line numbers\+:}} By default, the {\ttfamily ini\+\_\+handler} callback doesn\textquotesingle{}t receive the line number as a parameter. If you need that, add {\ttfamily -\/DINI\+\_\+\+HANDLER\+\_\+\+LINENO=1}.
\item {\bfseries{Call handler on new section\+:}} By default, inih only calls the handler on each {\ttfamily name=value} pair. To detect new sections (e.\+g., the INI file has multiple sections with the same name), add {\ttfamily -\/DINI\+\_\+\+CALL\+\_\+\+HANDLER\+\_\+\+ON\+\_\+\+NEW\+\_\+\+SECTION=1}. Your handler function will then be called each time a new section is encountered, with {\ttfamily section} set to the new section name but {\ttfamily name} and {\ttfamily value} set to NULL.
\end{DoxyItemize}\hypertarget{md_lib_2utils_2win_2inih_2_r_e_a_d_m_e_autotoc_md4}{}\doxysubsection{\texorpdfstring{Memory options}{Memory options}}\label{md_lib_2utils_2win_2inih_2_r_e_a_d_m_e_autotoc_md4}

\begin{DoxyItemize}
\item {\bfseries{Stack vs heap\+:}} By default, inih creates a fixed-\/sized line buffer on the stack. To allocate on the heap using {\ttfamily malloc} instead, specify {\ttfamily -\/DINI\+\_\+\+USE\+\_\+\+STACK=0}.
\item {\bfseries{Maximum line length\+:}} The default maximum line length (for stack or heap) is 200 bytes. To override this, add something like {\ttfamily -\/DINI\+\_\+\+MAX\+\_\+\+LINE=1000}. Note that {\ttfamily INI\+\_\+\+MAX\+\_\+\+LINE} must be 3 more than the longest line (due to {\ttfamily \textbackslash{}r}, {\ttfamily \textbackslash{}n}, and the NUL).
\item {\bfseries{Initial malloc size\+:}} {\ttfamily INI\+\_\+\+INITIAL\+\_\+\+ALLOC} specifies the initial malloc size when using the heap. It defaults to 200 bytes.
\item {\bfseries{Allow realloc\+:}} By default when using the heap ({\ttfamily -\/DINI\+\_\+\+USE\+\_\+\+STACK=0}), inih allocates a fixed-\/sized buffer of {\ttfamily INI\+\_\+\+INITIAL\+\_\+\+ALLOC} bytes. To allow this to grow to {\ttfamily INI\+\_\+\+MAX\+\_\+\+LINE} bytes, doubling if needed, set {\ttfamily -\/DINI\+\_\+\+ALLOW\+\_\+\+REALLOC=1}.
\item {\bfseries{Custom allocator\+:}} By default when using the heap, the standard library\textquotesingle{}s {\ttfamily malloc}, {\ttfamily free}, and {\ttfamily realloc} functions are used; to use a custom allocator, specify {\ttfamily -\/DINI\+\_\+\+CUSTOM\+\_\+\+ALLOCATOR=1} (and {\ttfamily -\/DINI\+\_\+\+USE\+\_\+\+STACK=0}). You must define and link functions named {\ttfamily ini\+\_\+malloc}, {\ttfamily ini\+\_\+free}, and (if {\ttfamily INI\+\_\+\+ALLOW\+\_\+\+REALLOC} is set) {\ttfamily ini\+\_\+realloc}, which must have the same signatures as the {\ttfamily stdlib.\+h} memory allocation functions.
\end{DoxyItemize}\hypertarget{md_lib_2utils_2win_2inih_2_r_e_a_d_m_e_autotoc_md5}{}\doxysection{\texorpdfstring{Simple example in C}{Simple example in C}}\label{md_lib_2utils_2win_2inih_2_r_e_a_d_m_e_autotoc_md5}

\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <stdio.h>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <stdlib.h>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <string.h>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ "{}../ini.h"{}}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{typedef}\ \textcolor{keyword}{struct}}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{int}\ version;}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ name;}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ email;}
\DoxyCodeLine{\}\ \mbox{\hyperlink{structconfiguration}{configuration}};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ handler(\textcolor{keywordtype}{void}*\ user,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ section,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ name,}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ value)}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{structconfiguration}{configuration}}*\ pconfig\ =\ (\mbox{\hyperlink{structconfiguration}{configuration}}*)user;}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{preprocessor}{\ \ \ \ \#define\ MATCH(s,\ n)\ strcmp(section,\ s)\ ==\ 0\ \&\&\ strcmp(name,\ n)\ ==\ 0}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{if}\ (MATCH(\textcolor{stringliteral}{"{}protocol"{}},\ \textcolor{stringliteral}{"{}version"{}}))\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ pconfig-\/>version\ =\ atoi(value);}
\DoxyCodeLine{\ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (MATCH(\textcolor{stringliteral}{"{}user"{}},\ \textcolor{stringliteral}{"{}name"{}}))\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ pconfig-\/>name\ =\ strdup(value);}
\DoxyCodeLine{\ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (MATCH(\textcolor{stringliteral}{"{}user"{}},\ \textcolor{stringliteral}{"{}email"{}}))\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ pconfig-\/>email\ =\ strdup(value);}
\DoxyCodeLine{\ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;\ \ \textcolor{comment}{/*\ unknown\ section/name,\ error\ */}}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{int}\ main(\textcolor{keywordtype}{int}\ argc,\ \textcolor{keywordtype}{char}*\ argv[])}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{structconfiguration}{configuration}}\ \mbox{\hyperlink{structconfig}{config}};}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{if}\ (ini\_parse(\textcolor{stringliteral}{"{}test.ini"{}},\ handler,\ \&\mbox{\hyperlink{structconfig}{config}})\ <\ 0)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}Can't\ load\ 'test.ini'\(\backslash\)n"{}});}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ printf(\textcolor{stringliteral}{"{}Config\ loaded\ from\ 'test.ini':\ version=\%d,\ name=\%s,\ email=\%s\(\backslash\)n"{}},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \mbox{\hyperlink{structconfig}{config}}.version,\ \mbox{\hyperlink{structconfig}{config}}.name,\ \mbox{\hyperlink{structconfig}{config}}.email);}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\}}

\end{DoxyCode}
\hypertarget{md_lib_2utils_2win_2inih_2_r_e_a_d_m_e_autotoc_md6}{}\doxysection{\texorpdfstring{C++ example}{C++ example}}\label{md_lib_2utils_2win_2inih_2_r_e_a_d_m_e_autotoc_md6}
If you\textquotesingle{}re into C++ and the STL, there is also an easy-\/to-\/use \href{https://github.com/benhoyt/inih/blob/master/cpp/INIReader.h}{\texttt{ INIReader class}} that stores values in a {\ttfamily map} and lets you {\ttfamily Get()} them\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ "{}INIReader.h"{}}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{int}\ main()}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{class_i_n_i_reader}{INIReader}}\ reader(\textcolor{stringliteral}{"{}../examples/test.ini"{}});}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{if}\ (reader.ParseError()\ <\ 0)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Can't\ load\ 'test.ini'\(\backslash\)n"{}};}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Config\ loaded\ from\ 'test.ini':\ version="{}}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ reader.GetInteger(\textcolor{stringliteral}{"{}protocol"{}},\ \textcolor{stringliteral}{"{}version"{}},\ -\/1)\ <<\ \textcolor{stringliteral}{"{},\ name="{}}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ reader.Get(\textcolor{stringliteral}{"{}user"{}},\ \textcolor{stringliteral}{"{}name"{}},\ \textcolor{stringliteral}{"{}UNKNOWN"{}})\ <<\ \textcolor{stringliteral}{"{},\ email="{}}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ reader.Get(\textcolor{stringliteral}{"{}user"{}},\ \textcolor{stringliteral}{"{}email"{}},\ \textcolor{stringliteral}{"{}UNKNOWN"{}})\ <<\ \textcolor{stringliteral}{"{},\ pi="{}}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ reader.GetReal(\textcolor{stringliteral}{"{}user"{}},\ \textcolor{stringliteral}{"{}pi"{}},\ -\/1)\ <<\ \textcolor{stringliteral}{"{},\ active="{}}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ reader.GetBoolean(\textcolor{stringliteral}{"{}user"{}},\ \textcolor{stringliteral}{"{}active"{}},\ \textcolor{keyword}{true})\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\}}

\end{DoxyCode}


This simple C++ API works fine, but it\textquotesingle{}s not very fully-\/fledged. I\textquotesingle{}m not planning to work more on the C++ API at the moment, so if you want a bit more power (for example {\ttfamily Get\+Sections()} and {\ttfamily Get\+Fields()} functions), see these forks\+:


\begin{DoxyItemize}
\item \href{https://github.com/Blandinium/inih}{\texttt{ https\+://github.\+com/\+Blandinium/inih}}
\item \href{https://github.com/OSSystems/inih}{\texttt{ https\+://github.\+com/\+OSSystems/inih}}
\end{DoxyItemize}\hypertarget{md_lib_2utils_2win_2inih_2_r_e_a_d_m_e_autotoc_md7}{}\doxysection{\texorpdfstring{Differences from Config\+Parser}{Differences from Config\+Parser}}\label{md_lib_2utils_2win_2inih_2_r_e_a_d_m_e_autotoc_md7}
Some differences between inih and Python\textquotesingle{}s \href{http://docs.python.org/library/configparser.html}{\texttt{ Config\+Parser}} standard library module\+:


\begin{DoxyItemize}
\item INI name=value pairs given above any section headers are treated as valid items with no section (section name is an empty string). In Config\+Parser having no section is an error.
\item Line continuations are handled with leading whitespace on continued lines (like Config\+Parser). However, instead of concatenating continued lines together, they are treated as separate values for the same key (unlike Config\+Parser).
\end{DoxyItemize}\hypertarget{md_lib_2utils_2win_2inih_2_r_e_a_d_m_e_autotoc_md8}{}\doxysection{\texorpdfstring{Platform-\/specific notes}{Platform-\/specific notes}}\label{md_lib_2utils_2win_2inih_2_r_e_a_d_m_e_autotoc_md8}

\begin{DoxyItemize}
\item Windows/\+Win32 uses UTF-\/16 filenames natively, so to handle Unicode paths you need to call {\ttfamily \+\_\+wfopen()} to open a file and then {\ttfamily ini\+\_\+parse\+\_\+file()} to parse it; inih does not include {\ttfamily wchar\+\_\+t} or Unicode handling.
\end{DoxyItemize}\hypertarget{md_lib_2utils_2win_2inih_2_r_e_a_d_m_e_autotoc_md9}{}\doxysection{\texorpdfstring{Meson notes}{Meson notes}}\label{md_lib_2utils_2win_2inih_2_r_e_a_d_m_e_autotoc_md9}

\begin{DoxyItemize}
\item The {\ttfamily meson.\+build} file is not required to use or compile inih, its main purpose is for distributions.
\item By default Meson is set up for distro installation, but this behavior can be configured for embedded use cases\+:
\begin{DoxyItemize}
\item with {\ttfamily -\/Ddefault\+\_\+library=static} static libraries are built.
\item with {\ttfamily -\/Ddistro\+\_\+install=false} libraries, headers and pkg-\/config files won\textquotesingle{}t be installed.
\item with {\ttfamily -\/Dwith\+\_\+\+INIReader=false} you can disable building the C++ library.
\end{DoxyItemize}
\item All compile-\/time options are implemented in Meson as well, you can take a look at \href{https://github.com/benhoyt/inih/blob/master/meson_options.txt}{\texttt{ meson\+\_\+options.\+txt}} for their definition. These won\textquotesingle{}t work if {\ttfamily distro\+\_\+install} is set to {\ttfamily true}.
\item If you want to use inih for programs which may be shipped in a distro, consider linking against the shared libraries. The pkg-\/config entries are {\ttfamily inih} and {\ttfamily \doxylink{class_i_n_i_reader}{INIReader}}.
\item In case you use inih as a Meson subproject, you can use the {\ttfamily inih\+\_\+dep} and {\ttfamily INIReader\+\_\+dep} dependency variables. You might want to set {\ttfamily default\+\_\+library=static} and {\ttfamily distro\+\_\+install=false} for the subproject. An official Wrap is provided on \href{https://wrapdb.mesonbuild.com/inih}{\texttt{ Wrap\+DB}}.
\item For packagers\+: if you want to tag the version in the pkg-\/config file, you will need to do this downstream. Add `version \+: '$<$version\+\_\+as\+\_\+int$>$\textquotesingle{},{\ttfamily after the}license{\ttfamily tag in the}project(){\ttfamily function and}version \+: meson.\+project\+\_\+version(),{\ttfamily after the}soversion{\ttfamily tag in both}library()\`{} functions.
\end{DoxyItemize}\hypertarget{md_lib_2utils_2win_2inih_2_r_e_a_d_m_e_autotoc_md10}{}\doxysection{\texorpdfstring{Using inih with tipi.\+build}{Using inih with tipi.\+build}}\label{md_lib_2utils_2win_2inih_2_r_e_a_d_m_e_autotoc_md10}
{\ttfamily inih} can be easily used in \href{https://tipi.build}{\texttt{ tipi.\+build}} projects simply by adding the following entry to your {\ttfamily .tipi/deps} (replace {\ttfamily r56} with the latest version tag)\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ \ \ "{}benhoyt/inih"{}:\ \{\ "{}@"{}:\ "{}r56"{}\ \}}
\DoxyCodeLine{\}}

\end{DoxyCode}


The required include path in your project is\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <ini.h>}}

\end{DoxyCode}
\hypertarget{md_lib_2utils_2win_2inih_2_r_e_a_d_m_e_autotoc_md11}{}\doxysection{\texorpdfstring{Building from vcpkg}{Building from vcpkg}}\label{md_lib_2utils_2win_2inih_2_r_e_a_d_m_e_autotoc_md11}
You can build and install inih using \href{https://github.com/microsoft/vcpkg/}{\texttt{ vcpkg}} dependency manager\+: \begin{DoxyVerb}git clone https://github.com/Microsoft/vcpkg.git
cd vcpkg
./bootstrap-vcpkg.sh
./vcpkg integrate install
./vcpkg install inih
\end{DoxyVerb}
 The inih port in vcpkg is kept up to date by microsoft team members and community contributors. If the version is out of date, please \href{https://github.com/Microsoft/vcpkg}{\texttt{ create an issue or pull request}} on the vcpkg repository.\hypertarget{md_lib_2utils_2win_2inih_2_r_e_a_d_m_e_autotoc_md12}{}\doxysection{\texorpdfstring{Related links}{Related links}}\label{md_lib_2utils_2win_2inih_2_r_e_a_d_m_e_autotoc_md12}

\begin{DoxyItemize}
\item \href{https://github.com/mohamedghita/conan-inih}{\texttt{ Conan package for inih}} (Conan is a C/\+C++ package manager) 
\end{DoxyItemize}