\doxysection{E\+:/\+One\+Drive -\/ The University of Nottingham/\+Year 5 Shared/\+FYP/\+Code/\+Uo\+NCube\+Sat/lib/ttc/li2/\+Li2.c File Reference}
\hypertarget{_li2_8c}{}\label{_li2_8c}\index{E:/OneDrive -\/ The University of Nottingham/Year 5 Shared/FYP/Code/UoNCubeSat/lib/ttc/li2/Li2.c@{E:/OneDrive -\/ The University of Nottingham/Year 5 Shared/FYP/Code/UoNCubeSat/lib/ttc/li2/Li2.c}}


~\newline
  


{\ttfamily \#include "{}Li2.\+h"{}}\newline
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
LI2\+\_\+\+RTNS \mbox{\hyperlink{_li2_8c_ad9f42688c249843c8501adb3746e8895}{Li2\+\_\+\+Init}} (\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}\+\_\+\+Li2, const char \texorpdfstring{$\ast$}{*}\+\_\+serial\+Port\+Name, uint32\+\_\+t \+\_\+serial\+Baud\+Rate, \mbox{\hyperlink{struct_l_i2___s_e_t_u_p}{LI2\+\_\+\+SETUP}} \+\_\+setup)
\begin{DoxyCompactList}\small\item\em Initialise Lithium Radio. \end{DoxyCompactList}\item 
LI2\+\_\+\+RTNS \mbox{\hyperlink{_li2_8c_a36f033fd74c724e2009348f975f4aeb5}{Li2\+\_\+\+TXData\+Packet}} (\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}\+\_\+\+Li2, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}\+\_\+data\+TX, uint8\+\_\+t \+\_\+len)
\begin{DoxyCompactList}\small\item\em Transmits a data packet via CDI. \end{DoxyCompactList}\item 
LI2\+\_\+\+RTNS \mbox{\hyperlink{_li2_8c_aead9fb354bc33fcf1a8493766bdb5065}{Li2\+\_\+\+RXData\+Packet}} (\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}\+\_\+\+Li2, uint8\+\_\+t \texorpdfstring{$\ast$}{*}\+\_\+data\+RX)
\item 
LI2\+\_\+\+RTNS \mbox{\hyperlink{_li2_8c_a180168c8e4ecb05042e2b73d90d73416}{Li2\+\_\+\+No\+Op}} (\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}\+\_\+\+Li2)
\begin{DoxyCompactList}\small\item\em Send No\+Op CDI Command. \end{DoxyCompactList}\item 
LI2\+\_\+\+RTNS \mbox{\hyperlink{_li2_8c_a88f6480ba2814cf2f355d7b55c6b9e1b}{Li2\+\_\+\+Reset}} (\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}\+\_\+\+Li2)
\item 
LI2\+\_\+\+RTNS \mbox{\hyperlink{_li2_8c_a2feb9a6591e84cf2728edddeb8948657}{Li2\+\_\+\+Get\+TXRXConfig}} (\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}\+\_\+\+Li2)
\item 
LI2\+\_\+\+RTNS \mbox{\hyperlink{_li2_8c_a208576c0a7442ffe99df8a3245970ba0}{Li2\+\_\+\+Get\+Telemetry}} (\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}\+\_\+\+Li2)
\item 
\Hypertarget{_li2_8c_a42c38f1f0900944f8565443c0ef3967b}\label{_li2_8c_a42c38f1f0900944f8565443c0ef3967b} 
LI2\+\_\+\+RTNS {\bfseries Li2\+\_\+\+Get\+Firm\+Rev} (\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}\+\_\+\+Li2)
\item 
\Hypertarget{_li2_8c_ad0cfcb38ad1950ca5439c0773d2de37a}\label{_li2_8c_ad0cfcb38ad1950ca5439c0773d2de37a} 
LI2\+\_\+\+RTNS {\bfseries Li2\+\_\+\+Set\+TXRXConfig} (\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}\+\_\+\+Li2, const \mbox{\hyperlink{struct_li2___t_x_r_x___config}{Li2\+\_\+\+TXRX\+\_\+\+Config}} \texorpdfstring{$\ast$}{*}\+\_\+\+TXRXConfig)
\item 
\Hypertarget{_li2_8c_a2489914b76198e3fdf54dd1d26114d1e}\label{_li2_8c_a2489914b76198e3fdf54dd1d26114d1e} 
LI2\+\_\+\+RTNS {\bfseries Li2\+\_\+\+Set\+RFConfig} (\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}\+\_\+\+Li2, const \mbox{\hyperlink{struct_li2___r_f___config}{Li2\+\_\+\+RF\+\_\+\+Config}} \texorpdfstring{$\ast$}{*}\+\_\+\+RFConfig)
\item 
LI2\+\_\+\+RTNS \mbox{\hyperlink{_li2_8c_a3ca4b310670c15340c72961fa4636ed3}{Li2\+\_\+\+Set\+Beacon\+Config}} (\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}\+\_\+\+Li2, const \mbox{\hyperlink{struct_li2___beacon___config}{Li2\+\_\+\+Beacon\+\_\+\+Config}} \texorpdfstring{$\ast$}{*}\+\_\+\+Beacon\+Config)
\item 
LI2\+\_\+\+RTNS \mbox{\hyperlink{_li2_8c_a3cfa68841505be8cc2b0f522ffdb2632}{Li2\+\_\+\+Set\+Beacon\+Data}} (\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}\+\_\+\+Li2, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}\+\_\+data, uint8\+\_\+t \+\_\+len)
\item 
LI2\+\_\+\+RTNS \mbox{\hyperlink{_li2_8c_a71134b173451452d4f533ea3706230b4}{LI2\+\_\+\+Set\+Power\+Amp}} (\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}\+\_\+\+Li2, uint8\+\_\+t \+\_\+power)
\item 
LI2\+\_\+\+RTNS \mbox{\hyperlink{_li2_8c_a14059840899cdfd5653300873f387918}{Li2\+\_\+\+Send\+CDICmd}} (\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}\+\_\+\+Li2, \mbox{\hyperlink{_li2___structs_8h_a4ea2346b8b3d19900d819b40e58a9572}{LI2\+\_\+\+CDI\+\_\+\+CMDS}} \+\_\+cmd, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}\+\_\+payload, uint16\+\_\+t \+\_\+payload\+Size)
\item 
LI2\+\_\+\+RTNS \mbox{\hyperlink{_li2_8c_a3c6581bcf38772549a279946b04789e5}{Li2\+\_\+\+Receive\+CDICmd}} (\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}\+\_\+\+Li2, \mbox{\hyperlink{_li2___structs_8h_a4ea2346b8b3d19900d819b40e58a9572}{LI2\+\_\+\+CDI\+\_\+\+CMDS}} \+\_\+expect\+Cmd)
\item 
LI2\+\_\+\+RTNS \mbox{\hyperlink{_li2_8c_a3d319bf681071efa1a1bb1ee5969d1dc}{Li2\+\_\+\+Read\+Header}} (\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}\+\_\+\+Li2, uint8\+\_\+t \texorpdfstring{$\ast$}{*}\+\_\+buffer\+RX, \mbox{\hyperlink{_li2___structs_8h_a4ea2346b8b3d19900d819b40e58a9572}{LI2\+\_\+\+CDI\+\_\+\+CMDS}} \+\_\+expect\+Cmd)
\begin{DoxyCompactList}\small\item\em Attempts to read the first 8 bytes waiting to find a valid header. \end{DoxyCompactList}\item 
LI2\+\_\+\+RTNS \mbox{\hyperlink{_li2_8c_aaab071f071f9d3fb44b3b2b0f58028df}{Li2\+\_\+\+Read\+Payload}} (\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}\+\_\+\+Li2, uint8\+\_\+t \texorpdfstring{$\ast$}{*}\+\_\+buffer\+RX, uint16\+\_\+t \+\_\+payload\+Len)
\item 
LI2\+\_\+\+RTNS \mbox{\hyperlink{_li2_8c_af36e2a550fcd23cdbd7d2a65fa71319f}{Li2\+\_\+\+Check\+Payload\+Size}} (\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}\+\_\+\+Li2, uint8\+\_\+t \+\_\+dir, \mbox{\hyperlink{_li2___structs_8h_a4ea2346b8b3d19900d819b40e58a9572}{LI2\+\_\+\+CDI\+\_\+\+CMDS}} \+\_\+cmd, uint16\+\_\+t \+\_\+payload\+Size)
\item 
LI2\+\_\+\+RTNS \mbox{\hyperlink{_li2_8c_a5809a00c174811dbe6ba421da63ea829}{Li2\+\_\+\+Raw\+Write}} (\mbox{\hyperlink{structsp__port}{Serial\+\_\+\+Port}} \texorpdfstring{$\ast$}{*}\+\_\+\+Port, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}\+\_\+data\+TX, uint16\+\_\+t \+\_\+len)
\item 
LI2\+\_\+\+RTNS \mbox{\hyperlink{_li2_8c_a705d571fe73500b1c7a58820048ae155}{Li2\+\_\+\+Raw\+Read}} (\mbox{\hyperlink{structsp__port}{Serial\+\_\+\+Port}} \texorpdfstring{$\ast$}{*}\+\_\+\+Serial\+Port, uint8\+\_\+t \texorpdfstring{$\ast$}{*}\+\_\+data\+RX, uint16\+\_\+t \+\_\+len)
\item 
LI2\+\_\+\+RTNS \mbox{\hyperlink{_li2_8c_abb716478e2a2b07a59ecd9b4376b730d}{Li2\+\_\+\+Send\+CDIAck}} (\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}\+\_\+\+Li2, \mbox{\hyperlink{_li2___structs_8h_a4ea2346b8b3d19900d819b40e58a9572}{LI2\+\_\+\+CDI\+\_\+\+CMDS}} \+\_\+cmd, uint8\+\_\+t \+\_\+ack\+Status)
\item 
\Hypertarget{_li2_8c_a1f016b8321c3594424ffca42e3562444}\label{_li2_8c_a1f016b8321c3594424ffca42e3562444} 
void {\bfseries Li2\+\_\+\+Calc\+CDIChecksums} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}\+\_\+checksums, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}\+\_\+data, uint16\+\_\+t \+\_\+len)
\item 
\Hypertarget{_li2_8c_a2cfb288a5c35249034734cc191fe544b}\label{_li2_8c_a2cfb288a5c35249034734cc191fe544b} 
void {\bfseries Li2\+\_\+\+AX25\+Decode} (\mbox{\hyperlink{struct_li2___a_x25___header}{Li2\+\_\+\+AX25\+\_\+\+Header}} \texorpdfstring{$\ast$}{*}\+\_\+\+AX25\+Header, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}\+\_\+data)
\item 
\Hypertarget{_li2_8c_aa36e4b50314879276aa6ef885ed67e56}\label{_li2_8c_aa36e4b50314879276aa6ef885ed67e56} 
void {\bfseries Li2\+\_\+\+Print\+Buffer} (const uint8\+\_\+t \texorpdfstring{$\ast$}{*}\+\_\+buffer, uint16\+\_\+t \+\_\+len, const char \texorpdfstring{$\ast$}{*}\+\_\+buffer\+Name)
\item 
\Hypertarget{_li2_8c_a56275be7121e7616ef710ca27e83fd6a}\label{_li2_8c_a56275be7121e7616ef710ca27e83fd6a} 
void {\bfseries Li2\+\_\+\+Print\+Telem} (const \mbox{\hyperlink{struct_li2___telemetry___packet}{Li2\+\_\+\+Telemetry\+\_\+\+Packet}} \texorpdfstring{$\ast$}{*}\+\_\+\+Telem)
\item 
\Hypertarget{_li2_8c_a786f2c9fa0a7fe22b2816e22260bcb37}\label{_li2_8c_a786f2c9fa0a7fe22b2816e22260bcb37} 
void {\bfseries Li2\+\_\+\+Print\+TXRXConfig} (const \mbox{\hyperlink{struct_li2___t_x_r_x___config}{Li2\+\_\+\+TXRX\+\_\+\+Config}} \texorpdfstring{$\ast$}{*}\+\_\+\+TXRXConfig)
\item 
\Hypertarget{_li2_8c_ab7fbda696c9836169281c3fd57c8cb16}\label{_li2_8c_ab7fbda696c9836169281c3fd57c8cb16} 
void {\bfseries Li2\+\_\+\+Print\+UARTStatus\+Bits} (const \mbox{\hyperlink{struct_li2___u_a_r_t___status___bits}{Li2\+\_\+\+UART\+\_\+\+Status\+\_\+\+Bits}} \texorpdfstring{$\ast$}{*}\+\_\+\+UARTStatus\+Bits)
\item 
\Hypertarget{_li2_8c_a86505612238df751a8f5560705d1dab2}\label{_li2_8c_a86505612238df751a8f5560705d1dab2} 
void {\bfseries Li2\+\_\+\+Print\+AX25\+Header} (const \mbox{\hyperlink{struct_li2___a_x25___header}{Li2\+\_\+\+AX25\+\_\+\+Header}} \texorpdfstring{$\ast$}{*}\+\_\+\+AX25\+Header)
\item 
\Hypertarget{_li2_8c_a738c30992e1333800b9f13acb06e3495}\label{_li2_8c_a738c30992e1333800b9f13acb06e3495} 
const char \texorpdfstring{$\ast$}{*} {\bfseries Li2\+\_\+\+Get\+CDIStr} (\mbox{\hyperlink{_li2___structs_8h_a4ea2346b8b3d19900d819b40e58a9572}{LI2\+\_\+\+CDI\+\_\+\+CMDS}} \+\_\+cmd)
\item 
uint8\+\_\+t \mbox{\hyperlink{_li2_8c_af835c8f23d71619006eb7ee4e89c329f}{Li2\+\_\+\+Rtn}} (LI2\+\_\+\+RTNS \+\_\+return\+Code, const char \texorpdfstring{$\ast$}{*}\+\_\+func, const char \texorpdfstring{$\ast$}{*}\+\_\+caller)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
~\newline
 

\begin{DoxyAuthor}{Author}
N. Lok 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
08/\+March/2024 
\end{DoxyDate}


\doxysubsection{Function Documentation}
\Hypertarget{_li2_8c_af36e2a550fcd23cdbd7d2a65fa71319f}\label{_li2_8c_af36e2a550fcd23cdbd7d2a65fa71319f} 
\index{Li2.c@{Li2.c}!Li2\_CheckPayloadSize@{Li2\_CheckPayloadSize}}
\index{Li2\_CheckPayloadSize@{Li2\_CheckPayloadSize}!Li2.c@{Li2.c}}
\doxysubsubsection{\texorpdfstring{Li2\_CheckPayloadSize()}{Li2\_CheckPayloadSize()}}
{\footnotesize\ttfamily LI2\+\_\+\+RTNS Li2\+\_\+\+Check\+Payload\+Size (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}}]{\+\_\+\+Li2,  }\item[{uint8\+\_\+t}]{\+\_\+dir,  }\item[{\mbox{\hyperlink{_li2___structs_8h_a4ea2346b8b3d19900d819b40e58a9572}{LI2\+\_\+\+CDI\+\_\+\+CMDS}}}]{\+\_\+cmd,  }\item[{uint16\+\_\+t}]{\+\_\+payload\+Size }\end{DoxyParamCaption})}

Debug

Check command received in the header

Two different versions

No Payload CDI Command

Two different versions

No Payload CDI Command

All Good\Hypertarget{_li2_8c_a208576c0a7442ffe99df8a3245970ba0}\label{_li2_8c_a208576c0a7442ffe99df8a3245970ba0} 
\index{Li2.c@{Li2.c}!Li2\_GetTelemetry@{Li2\_GetTelemetry}}
\index{Li2\_GetTelemetry@{Li2\_GetTelemetry}!Li2.c@{Li2.c}}
\doxysubsubsection{\texorpdfstring{Li2\_GetTelemetry()}{Li2\_GetTelemetry()}}
{\footnotesize\ttfamily LI2\+\_\+\+RTNS Li2\+\_\+\+Get\+Telemetry (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}}]{Li2 }\end{DoxyParamCaption})}






\begin{DoxyParams}{Parameters}
{\em \+\_\+\+Li2} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\end{DoxyReturn}
\Hypertarget{_li2_8c_a2feb9a6591e84cf2728edddeb8948657}\label{_li2_8c_a2feb9a6591e84cf2728edddeb8948657} 
\index{Li2.c@{Li2.c}!Li2\_GetTXRXConfig@{Li2\_GetTXRXConfig}}
\index{Li2\_GetTXRXConfig@{Li2\_GetTXRXConfig}!Li2.c@{Li2.c}}
\doxysubsubsection{\texorpdfstring{Li2\_GetTXRXConfig()}{Li2\_GetTXRXConfig()}}
{\footnotesize\ttfamily LI2\+\_\+\+RTNS Li2\+\_\+\+Get\+TXRXConfig (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}}]{Li2 }\end{DoxyParamCaption})}






\begin{DoxyParams}{Parameters}
{\em \+\_\+\+Li2} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\end{DoxyReturn}
Send CDI Command to get config

Rtn for an acknowledgement

Store in struct

All Good\Hypertarget{_li2_8c_ad9f42688c249843c8501adb3746e8895}\label{_li2_8c_ad9f42688c249843c8501adb3746e8895} 
\index{Li2.c@{Li2.c}!Li2\_Init@{Li2\_Init}}
\index{Li2\_Init@{Li2\_Init}!Li2.c@{Li2.c}}
\doxysubsubsection{\texorpdfstring{Li2\_Init()}{Li2\_Init()}}
{\footnotesize\ttfamily LI2\+\_\+\+RTNS Li2\+\_\+\+Init (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}}]{Li2,  }\item[{const char \texorpdfstring{$\ast$}{*}}]{serial\+Port\+Name,  }\item[{uint32\+\_\+t}]{serial\+Baud\+Rate,  }\item[{\mbox{\hyperlink{struct_l_i2___s_e_t_u_p}{LI2\+\_\+\+SETUP}}}]{setup }\end{DoxyParamCaption})}



Initialise Lithium Radio. 

Attempts to initialise serial port, set event handlers, establish comms and get lithium data.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em \texorpdfstring{$\ast$}{*}\+\_\+\+Li2} & Lithium object \\
\hline
\mbox{\texttt{ in}}  & {\em \texorpdfstring{$\ast$}{*}\+\_\+serial\+Port\+Name} & COM name for Serial \doxylink{struct_port}{Port} \\
\hline
\mbox{\texttt{ in}}  & {\em \+\_\+serial\+Baud\+Rate} & Baud Rate for Serial \doxylink{struct_port}{Port} \\
\hline
\mbox{\texttt{ in}}  & {\em \+\_\+segment} & Defines where lithium is being used, space or ground \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Li2\+\_\+\+OK if sucessful, Error Code (Negative) if failed 
\end{DoxyReturn}
Set Setup Flags in Lithium object

Debug

Attempt to Initialise the Radio Serial \doxylink{struct_port}{Port}

Skip Lithium tests if emulating

Send Noop to check comms

Get Firmware Revision

Debug

Get Tranceiver Configuration Settings

Debug

Set Beacon \doxylink{struct_config}{Config}

Set Beacon Data

Debug

Set Beacon Interval

Debug

Get Telemetry Data

Debug

All good

Debug\Hypertarget{_li2_8c_a180168c8e4ecb05042e2b73d90d73416}\label{_li2_8c_a180168c8e4ecb05042e2b73d90d73416} 
\index{Li2.c@{Li2.c}!Li2\_NoOp@{Li2\_NoOp}}
\index{Li2\_NoOp@{Li2\_NoOp}!Li2.c@{Li2.c}}
\doxysubsubsection{\texorpdfstring{Li2\_NoOp()}{Li2\_NoOp()}}
{\footnotesize\ttfamily LI2\+\_\+\+RTNS Li2\+\_\+\+No\+Op (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}}]{Li2 }\end{DoxyParamCaption})}



Send No\+Op CDI Command. 

Attempts to transmit a No\+Op CDI command and waits for an acknowledgement.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em \+\_\+\+Li2} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Li2\+\_\+\+OK if sucessful, Error Code (Negative) if failed 
\end{DoxyReturn}
Send No Op CDI command

Check for an acknowledgement\Hypertarget{_li2_8c_a705d571fe73500b1c7a58820048ae155}\label{_li2_8c_a705d571fe73500b1c7a58820048ae155} 
\index{Li2.c@{Li2.c}!Li2\_RawRead@{Li2\_RawRead}}
\index{Li2\_RawRead@{Li2\_RawRead}!Li2.c@{Li2.c}}
\doxysubsubsection{\texorpdfstring{Li2\_RawRead()}{Li2\_RawRead()}}
{\footnotesize\ttfamily LI2\+\_\+\+RTNS Li2\+\_\+\+Raw\+Read (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsp__port}{Serial\+\_\+\+Port}} \texorpdfstring{$\ast$}{*}}]{\+\_\+\+Serial\+Port,  }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{\+\_\+data\+RX,  }\item[{uint16\+\_\+t}]{\+\_\+len }\end{DoxyParamCaption})}

Reads for as many bytes specified by the header

All Good\Hypertarget{_li2_8c_a5809a00c174811dbe6ba421da63ea829}\label{_li2_8c_a5809a00c174811dbe6ba421da63ea829} 
\index{Li2.c@{Li2.c}!Li2\_RawWrite@{Li2\_RawWrite}}
\index{Li2\_RawWrite@{Li2\_RawWrite}!Li2.c@{Li2.c}}
\doxysubsubsection{\texorpdfstring{Li2\_RawWrite()}{Li2\_RawWrite()}}
{\footnotesize\ttfamily LI2\+\_\+\+RTNS Li2\+\_\+\+Raw\+Write (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsp__port}{Serial\+\_\+\+Port}} \texorpdfstring{$\ast$}{*}}]{\+\_\+\+Port,  }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{\+\_\+data\+TX,  }\item[{uint16\+\_\+t}]{\+\_\+len }\end{DoxyParamCaption})}

Writes to the serial port

Wait until all bytes have been transmitted to OS

Waits for OS buffered bytes to be TXed over hardware

All Good\Hypertarget{_li2_8c_a3d319bf681071efa1a1bb1ee5969d1dc}\label{_li2_8c_a3d319bf681071efa1a1bb1ee5969d1dc} 
\index{Li2.c@{Li2.c}!Li2\_ReadHeader@{Li2\_ReadHeader}}
\index{Li2\_ReadHeader@{Li2\_ReadHeader}!Li2.c@{Li2.c}}
\doxysubsubsection{\texorpdfstring{Li2\_ReadHeader()}{Li2\_ReadHeader()}}
{\footnotesize\ttfamily LI2\+\_\+\+RTNS Li2\+\_\+\+Read\+Header (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}}]{Li2,  }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{buffer\+RX,  }\item[{\mbox{\hyperlink{_li2___structs_8h_a4ea2346b8b3d19900d819b40e58a9572}{LI2\+\_\+\+CDI\+\_\+\+CMDS}}}]{expect\+Cmd }\end{DoxyParamCaption})}



Attempts to read the first 8 bytes waiting to find a valid header. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em \texorpdfstring{$\ast$}{*}\+\_\+\+Li2} & Lithium object. \\
\hline
\mbox{\texttt{ out}}  & {\em \texorpdfstring{$\ast$}{*}\+\_\+buffer\+RX} & Buffer to receive header bytes \\
\hline
\mbox{\texttt{ in}}  & {\em \+\_\+expect\+Cmd} & Expected command \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\end{DoxyReturn}
Blocks until bytes have been received

Sync serial communcation using sync characters

Checks if there\textquotesingle{}s still data waiting

Reads the first two bytes waiting to the RX buffer

Debug -\/ Print Sync Chars Read

Checks for sync characters

Read remain header bytes

Check direction byte is correct

Checks the expected cmd matches the cmd received or 0 for \+\_\+expect\+Cmd indicates don\textquotesingle{}t care.

Check Header Checksums

Good Header

Couldn\textquotesingle{}t find any sync characters\Hypertarget{_li2_8c_aaab071f071f9d3fb44b3b2b0f58028df}\label{_li2_8c_aaab071f071f9d3fb44b3b2b0f58028df} 
\index{Li2.c@{Li2.c}!Li2\_ReadPayload@{Li2\_ReadPayload}}
\index{Li2\_ReadPayload@{Li2\_ReadPayload}!Li2.c@{Li2.c}}
\doxysubsubsection{\texorpdfstring{Li2\_ReadPayload()}{Li2\_ReadPayload()}}
{\footnotesize\ttfamily LI2\+\_\+\+RTNS Li2\+\_\+\+Read\+Payload (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}}]{\+\_\+\+Li2,  }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{\+\_\+buffer\+RX,  }\item[{uint16\+\_\+t}]{\+\_\+payload\+Len }\end{DoxyParamCaption})}

Blocks until bytes have been received

Read payload and payload checksum into correct place in buffer

Decode AX25 Header, if present

Debug

Check Payload Checksum

All Good\Hypertarget{_li2_8c_a3c6581bcf38772549a279946b04789e5}\label{_li2_8c_a3c6581bcf38772549a279946b04789e5} 
\index{Li2.c@{Li2.c}!Li2\_ReceiveCDICmd@{Li2\_ReceiveCDICmd}}
\index{Li2\_ReceiveCDICmd@{Li2\_ReceiveCDICmd}!Li2.c@{Li2.c}}
\doxysubsubsection{\texorpdfstring{Li2\_ReceiveCDICmd()}{Li2\_ReceiveCDICmd()}}
{\footnotesize\ttfamily LI2\+\_\+\+RTNS Li2\+\_\+\+Receive\+CDICmd (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}}]{\+\_\+\+Li2,  }\item[{\mbox{\hyperlink{_li2___structs_8h_a4ea2346b8b3d19900d819b40e58a9572}{LI2\+\_\+\+CDI\+\_\+\+CMDS}}}]{\+\_\+expect\+Cmd }\end{DoxyParamCaption})}

Attempts to read a header for an expect command with valid sync characters

Merge payload size bytes into one variable

Check if Payload Size is an Acknowledgment or a Length

Update Packed UART Bits

NACK Received -\/ BAD

Update Packed UART Bits

ACK Received -\/ All Good

No Payload, so return

Check payload size received in the header

Read CDI CMD payload\Hypertarget{_li2_8c_a88f6480ba2814cf2f355d7b55c6b9e1b}\label{_li2_8c_a88f6480ba2814cf2f355d7b55c6b9e1b} 
\index{Li2.c@{Li2.c}!Li2\_Reset@{Li2\_Reset}}
\index{Li2\_Reset@{Li2\_Reset}!Li2.c@{Li2.c}}
\doxysubsubsection{\texorpdfstring{Li2\_Reset()}{Li2\_Reset()}}
{\footnotesize\ttfamily LI2\+\_\+\+RTNS Li2\+\_\+\+Reset (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}}]{Li2 }\end{DoxyParamCaption})}






\begin{DoxyParams}{Parameters}
{\em \+\_\+\+Li2} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\end{DoxyReturn}
Reset Radio

Rtn for an acknowledgement\Hypertarget{_li2_8c_af835c8f23d71619006eb7ee4e89c329f}\label{_li2_8c_af835c8f23d71619006eb7ee4e89c329f} 
\index{Li2.c@{Li2.c}!Li2\_Rtn@{Li2\_Rtn}}
\index{Li2\_Rtn@{Li2\_Rtn}!Li2.c@{Li2.c}}
\doxysubsubsection{\texorpdfstring{Li2\_Rtn()}{Li2\_Rtn()}}
{\footnotesize\ttfamily uint8\+\_\+t Li2\+\_\+\+Rtn (\begin{DoxyParamCaption}\item[{LI2\+\_\+\+RTNS}]{\+\_\+return\+Code,  }\item[{const char \texorpdfstring{$\ast$}{*}}]{\+\_\+func,  }\item[{const char \texorpdfstring{$\ast$}{*}}]{\+\_\+caller }\end{DoxyParamCaption})}

Check return code\Hypertarget{_li2_8c_aead9fb354bc33fcf1a8493766bdb5065}\label{_li2_8c_aead9fb354bc33fcf1a8493766bdb5065} 
\index{Li2.c@{Li2.c}!Li2\_RXDataPacket@{Li2\_RXDataPacket}}
\index{Li2\_RXDataPacket@{Li2\_RXDataPacket}!Li2.c@{Li2.c}}
\doxysubsubsection{\texorpdfstring{Li2\_RXDataPacket()}{Li2\_RXDataPacket()}}
{\footnotesize\ttfamily LI2\+\_\+\+RTNS Li2\+\_\+\+RXData\+Packet (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}}]{Li2,  }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{data\+RX }\end{DoxyParamCaption})}






\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em \texorpdfstring{$\ast$}{*}\+\_\+\+Li2} & \\
\hline
\mbox{\texttt{ out}}  & {\em \+\_\+data\+RX} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Li2\+\_\+\+OK if sucessful, Error Code (Negative) if failed 
\end{DoxyReturn}
\Hypertarget{_li2_8c_abb716478e2a2b07a59ecd9b4376b730d}\label{_li2_8c_abb716478e2a2b07a59ecd9b4376b730d} 
\index{Li2.c@{Li2.c}!Li2\_SendCDIAck@{Li2\_SendCDIAck}}
\index{Li2\_SendCDIAck@{Li2\_SendCDIAck}!Li2.c@{Li2.c}}
\doxysubsubsection{\texorpdfstring{Li2\_SendCDIAck()}{Li2\_SendCDIAck()}}
{\footnotesize\ttfamily LI2\+\_\+\+RTNS Li2\+\_\+\+Send\+CDIAck (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}}]{\+\_\+\+Li2,  }\item[{\mbox{\hyperlink{_li2___structs_8h_a4ea2346b8b3d19900d819b40e58a9572}{LI2\+\_\+\+CDI\+\_\+\+CMDS}}}]{\+\_\+cmd,  }\item[{uint8\+\_\+t}]{\+\_\+ack\+Status }\end{DoxyParamCaption})}

Blocks RX ready

Write to serial port\Hypertarget{_li2_8c_a14059840899cdfd5653300873f387918}\label{_li2_8c_a14059840899cdfd5653300873f387918} 
\index{Li2.c@{Li2.c}!Li2\_SendCDICmd@{Li2\_SendCDICmd}}
\index{Li2\_SendCDICmd@{Li2\_SendCDICmd}!Li2.c@{Li2.c}}
\doxysubsubsection{\texorpdfstring{Li2\_SendCDICmd()}{Li2\_SendCDICmd()}}
{\footnotesize\ttfamily LI2\+\_\+\+RTNS Li2\+\_\+\+Send\+CDICmd (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}}]{\+\_\+\+Li2,  }\item[{\mbox{\hyperlink{_li2___structs_8h_a4ea2346b8b3d19900d819b40e58a9572}{LI2\+\_\+\+CDI\+\_\+\+CMDS}}}]{\+\_\+cmd,  }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{\+\_\+payload,  }\item[{uint16\+\_\+t}]{\+\_\+payload\+Size }\end{DoxyParamCaption})}

Debug

Debug

Blocks RX ready

Write to serial port\Hypertarget{_li2_8c_a3ca4b310670c15340c72961fa4636ed3}\label{_li2_8c_a3ca4b310670c15340c72961fa4636ed3} 
\index{Li2.c@{Li2.c}!Li2\_SetBeaconConfig@{Li2\_SetBeaconConfig}}
\index{Li2\_SetBeaconConfig@{Li2\_SetBeaconConfig}!Li2.c@{Li2.c}}
\doxysubsubsection{\texorpdfstring{Li2\_SetBeaconConfig()}{Li2\_SetBeaconConfig()}}
{\footnotesize\ttfamily LI2\+\_\+\+RTNS Li2\+\_\+\+Set\+Beacon\+Config (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}}]{\+\_\+\+Li2,  }\item[{const \mbox{\hyperlink{struct_li2___beacon___config}{Li2\+\_\+\+Beacon\+\_\+\+Config}} \texorpdfstring{$\ast$}{*}}]{\+\_\+\+Beacon\+Config }\end{DoxyParamCaption})}

All Good\Hypertarget{_li2_8c_a3cfa68841505be8cc2b0f522ffdb2632}\label{_li2_8c_a3cfa68841505be8cc2b0f522ffdb2632} 
\index{Li2.c@{Li2.c}!Li2\_SetBeaconData@{Li2\_SetBeaconData}}
\index{Li2\_SetBeaconData@{Li2\_SetBeaconData}!Li2.c@{Li2.c}}
\doxysubsubsection{\texorpdfstring{Li2\_SetBeaconData()}{Li2\_SetBeaconData()}}
{\footnotesize\ttfamily LI2\+\_\+\+RTNS Li2\+\_\+\+Set\+Beacon\+Data (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}}]{\+\_\+\+Li2,  }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{\+\_\+data,  }\item[{uint8\+\_\+t}]{\+\_\+len }\end{DoxyParamCaption})}

All Good\Hypertarget{_li2_8c_a71134b173451452d4f533ea3706230b4}\label{_li2_8c_a71134b173451452d4f533ea3706230b4} 
\index{Li2.c@{Li2.c}!LI2\_SetPowerAmp@{LI2\_SetPowerAmp}}
\index{LI2\_SetPowerAmp@{LI2\_SetPowerAmp}!Li2.c@{Li2.c}}
\doxysubsubsection{\texorpdfstring{LI2\_SetPowerAmp()}{LI2\_SetPowerAmp()}}
{\footnotesize\ttfamily LI2\+\_\+\+RTNS LI2\+\_\+\+Set\+Power\+Amp (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}}]{\+\_\+\+Li2,  }\item[{uint8\+\_\+t}]{\+\_\+power }\end{DoxyParamCaption})}

All Good\Hypertarget{_li2_8c_a36f033fd74c724e2009348f975f4aeb5}\label{_li2_8c_a36f033fd74c724e2009348f975f4aeb5} 
\index{Li2.c@{Li2.c}!Li2\_TXDataPacket@{Li2\_TXDataPacket}}
\index{Li2\_TXDataPacket@{Li2\_TXDataPacket}!Li2.c@{Li2.c}}
\doxysubsubsection{\texorpdfstring{Li2\_TXDataPacket()}{Li2\_TXDataPacket()}}
{\footnotesize\ttfamily LI2\+\_\+\+RTNS Li2\+\_\+\+TXData\+Packet (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_li2___radio}{Li2\+\_\+\+Radio}} \texorpdfstring{$\ast$}{*}}]{Li2,  }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{data\+TX,  }\item[{uint8\+\_\+t}]{len }\end{DoxyParamCaption})}



Transmits a data packet via CDI. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em \texorpdfstring{$\ast$}{*}\+\_\+\+Li2} & \\
\hline
\mbox{\texttt{ in}}  & {\em \+\_\+data\+TX} & \\
\hline
\mbox{\texttt{ in}}  & {\em \+\_\+len} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\end{DoxyReturn}
